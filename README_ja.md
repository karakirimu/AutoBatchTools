# AutoBatchRunner
-----
コマンドラインのアプリケーションをバッチ処理を実行するためのソフトウェアです。このソフトウェアは、以下の処理をGUIを利用して容易にする目的で作成されました。

- 処理だけを並べたスクリプトの再編集
- 特定の条件のファイルを抜き出そうとするとfindやgrepなどを多用しなければならない煩雑な検索
- 既存のcmdやshellなどのスクリプトで実装が難しい機能の拡張
- 1度作成したバッチ処理の再利用



## 対応OS

-----

Windows 10 x64 で動作確認



## このソフトウェアができること

-----

- exe、スクリプト等のプロファイルの作成・編集 (ProfileEditor)
- 作成したプロファイルの実行 (AutoBatchScheduler)
- 作成したプロファイルのスケジュール実行 (AutoBatchRunner)



## 使い方

-----





## 各ウィンドウの説明

-----

### ProfileEditor

ウィンドウ上には、メイン(Edit)、Process,Variant,Console,Fileのドックが存在しています。Edit、Process、Variantは主にプロファイルの編集に使用します。Run、Consoleは編集したプロファイルの実行テストに使用します。

#### Variant

このプログラムは後述するEdit機能のExecution,Pluginにおいて変数を使用することが可能です。変数はGlobal,Local,InputFileの3種類が存在します。変数名はGlobal→Local→InputFileの順に変換されます。

##### <u>Global</u>

  アプリケーション内で保存される共通変数です。一度登録すると作成するすべてのプロファイルで使用することが可能です。

##### <u>Local</u>

プロファイル内に保存される変数です。作成したプロファイル内で使用することが可能です。

##### <u>InputFile</u>

入力ファイル名を呼び出すときに使用される変数です。変数名は予約されており、以下の命名規則に従って自動的に変数が設定されます。

```
命名規則: 番号は0から開始

$input_番号_full$　     // 入力ファイルのフルパス
$input_番号_dir$        // 入力ファイルのフォルダパス
$input_番号_name$       // 入力ファイル名
$input_番号_basename$   // 拡張子なしのファイル名
$input_番号_extension$  // 入力ファイルの拡張子
```

```
例: 入力ファイルが"C:\test\motion.mp4"の場合

$input_0_full$　        // "C:\test\motion.mp4"
$input_0_dir$           // "C:\test"
$input_0_name$          // "motion.mp4"
$input_0_basename$      // "motion"
$input_0_extension$     // "mp4"
```



#### Edit

  情報と実行、ファイル検索、プラグイン、プロファイル読み込みの4種類の機能が搭載されています。以下に機能の種類と詳細を記述します。

  1. ##### Information

     情報の表示機能です。プロファイルを作成する時に必ず最初に作成されます。プロファイル名、著者、バージョン、説明を記述することができ、作成するプロファイルに対するを設定を行うことができます。

     | ファイル変数           | 詳細                                                         |
     | ---------------------- | ------------------------------------------------------------ |
     | ファイル入力の許可     | プロファイルの実行時、ファイルの入力を許可するか設定します。チェックが有効の場合、ファイルの入力が許可されます。 |
     | 検索結果を入力とするか | 後述するFileSearchの条件により出力されたファイルのリストを入力することができます。この設定が有効になると、通常のファイル入力はどうなるか忘れました。(要調査) |

     | ループ条件                   | 詳細                                                         |
     | ---------------------------- | ------------------------------------------------------------ |
     | 1回の実行で入力する変数の数  | プロファイルは1回の実行内で入力ファイルを引数として使用することができ、1回で入力するファイル変数の数を指定します。 |
     | 再帰回数                     | ProfileLoad機能は自分自身を登録すると自己呼び出しを行い、再帰ループを行うことができます。無限ループ状態を避けるためにこのオプションが存在しており、前述した問題を解決するために再帰の上限回数が指定されます。 |
     | 入力ファイルをすべて処理する | チェックを有効にすると、入力されたファイルをすべて処理します。 |
     | ループ回数                   | '入力ファイルをすべて処理する'のチェックを無効にすると有効化されます。このプロセスを実行する最大回数を指定します。 |

     

  2. ##### Executable

     exeファイルやbatファイル等の実行の編集を行うことができます。Executable file / Argumentsというヘッダーのテーブルが提供されます。テーブルの1行に一つずつファイルと変数を記述する必要があります。

     

     ##### オプション

     - タイムアウト

       何らかの理由でファイルが起動できなかった、ビジー状態になった場合のタイムアウト時間の設定を行うことができます。チェックしない場合はタイムアウト時間は無限になります。

       

     - スケジュール実行時のみ実行

       スケジュール実行時のみに実行する場合、チェックを有効にしてください。

     

  3. ##### FileSearch

     検索設定を追加することでファイル検索が可能です。検索設定はアプリケーション間で共有されます。検索結果のファイルパスは連結され1行で返却されます。検索結果が複数存在する場合、区切り文字を設定することでファイル名を分割できます。ファイルの検索結果はVariantの変数に保存するか、ファイルに出力することが可能です。

     

     - 適用する設定

       ファイル検索の設定を選択します。＋ボタンをクリックすると検索設定を作成するダイアログが表示されます。-ボタンをクリックすると選択した検索設定を削除することができます。ペンのアイコンをクリックすると選択したファイル検索設定の編集を行うことができます。

       

     - 区切り文字

       検索結果を出力するときの区切り文字を設定します。通常の文字の他に、改行、タブに対応しています。

       ```
       改行 : \n
       タブ : \t
       ```

       

     - 出力

       検索結果の出力先です。Global,Local変数に保持するか、ファイルに出力することが可能です。ファイルに出力を選択した場合、出力先に同名のファイルが存在する場合は必ず上書きされます。
       
       

     ##### オプション

     - スケジュール実行時のみ実行

       スケジュール実行時のみに実行する場合、チェックを有効にしてください。

       

  4. ##### Plugins

     プラグインを追加することで、独自機能追加が可能です。プラグインの追加方法は、

     - ＋ボタンを押して追加する
     - プログラム内のpluginsフォルダにファイルを直接コピーする

     の2種類です。

     

     プラグイン(dllファイル)を作成することによって、機能拡張を行うことが可能です。プラグインの作成法については、以降の章を参考にしてください。

     

     ##### オプション

     - スケジュール実行時のみ実行

       スケジュール実行時のみに実行する場合、チェックを有効にしてください。

       

  5. ##### ProfileLoad

     ProfileEditorで作成した別プロファイルの設定が可能です。編集中のファイルを保存している場合、自分自身を設定することも可能です。自己プロファイルを設定する場合は、Information → ループ条件 → 再帰回数を参照してください。

     

     ##### オプション

     - スケジュール実行時のみ実行

       スケジュール実行時のみに実行する場合、チェックを有効にしてください。

#### Process

ProcessウィンドウはEdit機能の実行順序を決定します。順序の追加、削除等の機能が実装されています。

- ファイルは常に上から実行されます.

#### Run

編集しているプロファイルのテスト用です。ファイルの入力、実行による動作確認が可能です。"実行範囲...”と書かれているテキストボックスを入力すると、Processウィンドウに対応した番号の処理のみを実行することができます。実行範囲の入力フォーマットは

```
1-7     // 開始-終了
8,10,11 // 8と10と11を実行(カンマ区切り)
1-4,6,7 // これもOK
```

のように記述可能です。ハイフンの記述とカンマの記述を組み合わせることも可能です。

#### Console

実行時に出力が表示されます。入力を求められたときは、下側の">”がある部分のテキストボックスをクリックし、必要な文字列をとEnterを入力すると反映できます。Enterそのものを送信する場合はEnterを2回押すと入力されます。



### 設定

#### 一般

- 一時ファイルの場所
- 自動セーブ時間間隔
- テーマ



#### テスト

- スケジューラとして実行



#### 検索

検索条件の管理



#### プラグイン

プラグインの管理

Auto-Detected

Manual



### 実行 (BatchRunner)

#### メインウィンドウ

#### Console



### スケジューラ (Scheduler)





## プラグインの作成について

-----



## サンプルプロファイル

-----

### 動画クロップ → 変換 (ffmpeg)

### フォルダ内のすべての画像を検索しコピー→縮小変換 (ImageMagick)





## 変更履歴

-----

Version 1.0.0.0 初期リリース



## ライセンス

-----

ソースコードはApache 2.0に準拠します。